# C++ Logging Solution

[GITHUB](https://github.com/murph666/infotecs_test_task)


Многопоточная система логирования, состоящая из библиотеки логирования и консольного приложения для управления записью логов.

## Структура проекта

```
infotecs/
├── libs/
│   └── logger/              # Библиотека логирования
│       ├── include/
│       │   ├── logger.h     # Основной класс логгера
│       │   └── log_level.h  # Уровни логирования и команды
│       └── src/
│           └── logger.cpp   # Реализация логгера
├── src/
│   └── app/                 # Слои приложения (MVP)
│       ├── application.*    # Главный класс приложения
│       ├── model_layer.*    # Модель (работа с данными)
│       ├── presenter_layer.*# Презентер (бизнес-логика)
│       ├── tui_layer.*      # Представление (консольный интерфейс)
│       └── I*.h             # Интерфейсы для слоев
│   
└── main.cpp                 # Точка входа
```

## Возможности

### Библиотека логирования (`libs/logger`)

- **Многопоточность**: Асинхронная запись в файл через отдельный рабочий поток
- **Уровни важности**: DEBUG, INFO, ERROR с фильтрацией по минимальному уровню
- **Потокобезопасность**: Защищенная очередь сообщений с мьютексами
- **Гибкая сборка**: Поддержка статической и динамической компиляции
- **Формат записи**: `[дд-мм-гггг чч:мм:сс] [УРОВЕНЬ] сообщение`

### Консольное приложение

- **MVP архитектура**: Разделение на Model, View, Presenter
- **Интерактивный интерфейс**: Консольное управление с помощью команд
- **Гибкая настройка**: Параметры командной строки для файла лога и уровня по умолчанию

## Сборка

### Требования
- CMake 3.24+
- C++17 совместимый компилятор
- POSIX Threads

### Компиляция

```bash
# Клонирование репозитория
git clone <repository-url>
cd infotecs

# Статическая сборка (по умолчанию)
mkdir build && cd build
cmake ..
make

# Динамическая сборка
mkdir build && cd build
cmake -DBUILD_SHARED_LIBS=ON ..
make
```

## Использование

### Запуск приложения

```bash
# Основной запуск
./infotecs

# С параметрами
./infotecs [имя_файла_лога] [уровень_по_умолчанию]

# Примеры
./infotecs app.log INFO
./infotecs debug.log DEBUG
```

### Команды интерфейса

#### Запись сообщений
```
# Сообщение с явным уровнем
Привет мир INFO
Произошла ошибка ERROR
Отладочная информация DEBUG

# Сообщение с уровнем по умолчанию
Простое сообщение
```

#### Управление уровнем логирования
```
# Показать текущий уровень
level

# Изменить уровень
level DEBUG
level INFO  
level ERROR
```

#### Служебные команды
```
help    # Показать справку
quit    # Выход из программы
exit    # Альтернатива quit
```

### Пример сессии

```
=== Logger Application ===
Текущий уровень логирования по умолчанию: INFO

> Тестовое сообщение INFO
Записано: Тестовое сообщение

> level DEBUG
Записано: Уровень логирования изменен на DEBUG

> Отладочное сообщение DEBUG  
Записано: Отладочное сообщение

> quit
До свидания!
```

## API библиотеки

### Основные классы

```cpp
namespace IFTlogs {
    // Уровни логирования
    enum class LogLevel {
        DEBUG = 0,
        INFO = 1, 
        ERROR = 2,
        NONE = 3
    };
    
    // Основной класс логгера
    class Logger {
    public:
        Logger(const std::string& filename, LogLevel default_level = LogLevel::INFO);
        
        void addLogMessage(const std::string& message, LogLevel level);
        int setDefaultLevel(LogLevel level);
        LogLevel getDefaultLevel() const;
    };
}
```

### Пример использования в коде

```cpp
#include "logger.h"

int main() {
    // Создание логгера
    IFTlogs::Logger logger("app.log", IFTlogs::LogLevel::INFO);
    
    // Запись сообщений
    logger.addLogMessage("Приложение запущено", IFTlogs::LogLevel::INFO);
    logger.addLogMessage("Отладочная информация", IFTlogs::LogLevel::DEBUG); // Не запишется
    
    // Изменение уровня
    logger.setDefaultLevel(IFTlogs::LogLevel::DEBUG);
    logger.addLogMessage("Теперь запишется", IFTlogs::LogLevel::DEBUG);
    
    return 0;
}
```

## Архитектурные особенности

### Многопоточность
- **Основной поток**: Обработка пользовательского ввода
- **Рабочий поток логгера**: Асинхронная запись в файл
- **Потокобезопасная очередь**: Ограничение в 100 сообщений с автоматической перезаписью

### MVP паттерн
- **Model** (`model_layer`): Управление логгером
- **View** (`tui_layer`): Консольный интерфейс
- **Presenter** (`presenter_layer`): Обработка команд и координация

### Безопасность
- Защита от переполнения очереди
- Корректное завершение потоков
- Обработка исключений при инициализации

## Формат лог-файла

```
[24-08-2025 14:30:15] [INFO] Приложение запущено
[24-08-2025 14:30:16] [DEBUG] Отладочная информация
[24-08-2025 14:30:17] [ERROR] Произошла ошибка
```